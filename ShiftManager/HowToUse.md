# ShiftManager 使い方

## 起動方法
Windows7以降のPCで, ShiftManager.exeをダブルクリックすると起動できます  
なお, 場合によっては .NEt5 Desktop Runtimeのインストールを要求される場合があります.  その場合は, 最新の[.NET 5 Desktop Runtime](https://dotnet.microsoft.com/download/dotnet/5.0)をダウンロード/インストールして下さい

---
## サインイン
Debugビルド以外では, 起動直後はサインイン画面が表示されます.  その表示に従い, ユーザID(従業員番号)とパスワードを入力し, 「ログイン」ボタンを押下してください

サインインに成功すると自動でサインイン用の表示が消え, 右上にユーザの氏名と「サインアウト」ボタンが表示されます

起動時にIDとパスワードを指定してサインインを試行するには, 実行時引数に以下のオプションを指定します (未実装) なお, いずれも既定値は空文字列(`string.Empty`)です

```
--ID ID000000 --PW 0000
```
ID文字列`ID000000`とパスワード文字列`0000`は適宜変更してください.  なお, いずれか片方のみが指定されていた場合, 指定された文字列がサインインフォームに入力された状態で起動します

## サインアウト
サインイン中の状態で, 画面右上に表示されている「サインアウト」ボタンを押下すると, サインアウトが実行されサインイン用の表示が出現します

サインアウト機能を無効化する場合は, 実行時引数に以下のオプションを指定します (未実装) なお, 既定値は`true`です

```
--CanSignOut false
```

---
## シフト希望登録
自身のシフト希望を編集し, 登録するためのページです

左上の日付選択用コントロールにて日付を選択すると, 選択された日付から28日後までのシフト希望入力欄が表示されます.  
シフト希望の編集が完了したら, 右上に表示されている「保存」ボタンを押下してください.  自動保存は行われませんので, ご注意ください.

シフト希望の編集方法については, [シフト表示/操作用コントロール](#シフト表示操作用コントロール)をご確認ください.


## 予定シフト表示
自身の予定シフトを確認するためのページです

左上の日付選択用コントロールにて日付を選択すると, 選択された日付から28日後までの予定シフトが表示されます.  
自動更新は行われませんので, 表示の更新を行いたい場合はメニューより再度「予定シフト表示」ボタンを押下してください.  ページの再読み込みが行われます.

予定シフト表示の見方については, [シフト表示/操作用コントロール](#シフト表示操作用コントロール)をご確認ください.


## 勤務実績表示
自身の勤務実績を確認するためのページです

左上の日付選択用コントロールにて日付を選択すると, 選択された日付から28日前までの勤務実績が表示されます.  
自動更新は行われませんので, 表示の更新を行いたい場合はメニューより再度「勤務実績表示」ボタンを押下してください.  ページの再読み込みが行われます.

勤務実績表示の見方については, [シフト表示/操作用コントロール](#シフト表示操作用コントロール)をご確認ください.

## ~~シフト印刷~~
未実装

## ユーザ設定
現在のユーザの「氏名」, 「パスワード」, 「UserGroup」, 「UserState」を編集することができるページです

パスワードについて, 「パスワード自動生成」ボタンを押下すると, 自動でランダムなパスワードが生成され, パスワード入力欄に入力されます.  
入力されたパスワードは, 入力ボックス下にある「パスワードを表示する」チェックボックスにチェックを入れると表示されますので, ご活用ください.

「パスワード自動生成」ボタンの下にあるバー表示は, パスワードの強度を表示するコントロールです.  バーが右に行くほど強力なパスワードになります.

苗字(Last Name), 名前(First Name), UserGroup, UserStateについては, 「保存」ボタン押下時の状態がそのまま上書き保存されます.  
パスワードについては, 入力欄に何らかの文字が行われており, かつそれが脆弱な物でない場合に限り更新が行われます.

---
## 予定シフト作成
従業員から提出されたシフト希望をもとに, 予定シフトを組むためのページです.

左上の日付選択コントロールにて日付を選択すると, その日の希望シフト一覧と予定シフトが表示されます.

「ShiftSchedulingState」コンボボックスでは, シフト組みの作業状態を設定することができます (未実装)  
なお, このコンボボックスでは, 変更が即座に保存されます.  右に表示されている「Save」ボタンを押す必要はありません.

シフト表示のうち, 上段のScrollViewに表示されているのが, `UserState==Normal`な従業員のシフト希望と, その他の従業員によって提出されたシフト希望です.  閲覧のみ可能で, 編集はできません.  
下段のScrollViewに表示されているのが, `UserState==Normal`な従業員と, シフト希望を提出したその他の従業員, および予定シフトファイル内に存在するその他の従業員用の予定シフト入力欄です.

上段のScrollViewと下段のScrollViewは, 表示位置が同期します.  一方をスクロールすると, もう一方も概ね同じ位置を表示します.

シフト表示の見方および編集方法については, [シフト表示/操作用コントロール](#シフト表示操作用コントロール)をご確認ください.

予定シフトの編集が完了したら, 「Save」ボタンを押下してください.  予定シフトが保存されます.  
また, 日付の変更やページ移動でも自動で保存されます.  

## 新規従業員追加
新規に従業員を追加することができます.  
パスワードについて, 脆弱なパスワードは設定できませんので, ご注意ください.

「変更破棄」を押すと, 入力された内容がすべてクリアされます.

## ~~データ管理~~
未実装

## 勤怠登録モード
勤怠登録を行うページです.  
表示されている時刻は参考程度であり, この時刻が打刻されるわけではありません.  

左下にあるユーザID(従業員番号)入力欄にIDを入力したうえで, その下に表示されている「出勤」, 「休入」, 「休出」, 「退勤」いずれかのボタンを押すと, 打刻を行うことができます.

なお, 打刻には以下の制約がつきます

- 「出勤」は, はじめての出勤であるか, あるいは退勤済みでないと行うことができません
- 「休入」は, 勤務中以外に行うことができません
- 「休出」は, 休憩中以外に行うことができません
- 「退勤」は, 勤務中以外に行うことができません

ページ右側上段に表示されているのは, その日の予定シフトです.  出勤時刻順に並んでいます

ページ右側下段に表示されているのは, 勤怠打刻の履歴です.  出勤打刻をした時間順に並んでいます.  
なお, 実装の都合上, ページを移動すると勤怠だ刻の履歴表示がクリアされますので, ご注意ください.

---
## Third Party License
メニューに表示された「Third Party License」ボタンを押下すると, 本ソフトウェアで使用しているサードパーティライブラリのライセンス表記を別ウィンドウから確認することができます

## Close Application
アプリケーションを終了することができます.  なお, 各ページで行われた変更は, 基本的に警告なく破棄されたうえで終了します.  終了前に保存を忘れないようにしてください

---
## シフト表示/操作用コントロール
ある単一日のシフトを表示し, また編集機能を提供するコントロールです.

表示左側より, 「コンテンツ」(ユーザID, 氏名など), 「出勤時刻」, 「退勤時刻」, 「休憩時間表示/操作コントロール表示用ボタン」, 「バー型シフト表示/操作コントロール」, 「勤務時間長」, 「データ削除ボタン」です.  なお, それぞれ任意に非表示にすることができるため, 例えば「データ削除」ボタンは一部ページでは表示されません.

本コントロール内では, 以下の相互作用を実装しています.

- 出勤時間を変更すると, バー表示と勤務時間長が更新されます.
- 退勤時間を変更すると, バー表示と勤務時間長が更新されます.
- 勤務時間長を変更すると, 出勤時間から勤務時間長だけ勤務し, また休憩をとった場合の退勤時間に更新されたうえで, バー表示が更新されます.
- 休憩時間設定が更新されると, バー表示と勤務時間長が更新されます.
- バー表示が操作されると, それにあわせて出勤時間, 退勤時間, 休憩時間, 勤務時間長が更新されます.

なお, 勤務時間長がマイナスになってしまった場合, 勤務時間長表示の文字が赤色になったうえで負の時間が表示されます.

## 休憩時刻表示/操作用コントロール
休憩時間設定を行うためのコントロールです

表示内右上の「追加」ボタンを押下すると, 表示内下部に表示されるリストに休憩時間設定が追加されます.  なお, 00:00に開始する休憩の設定が既に存在する場合, 追加は行われませんので, ご注意ください.

表示内下部のリストにて休憩設定の行を選択したうえで, 表示内右上の「削除」ボタンを押下すると, 選択された休憩設定が削除されます.

表示内下部のリストについて, 各行内にて以下の相互関係を実装しています.

- 休入時間を変更すると, 休憩時間長を変更しないように休出時間が更新されます
- 休出時間を変更すると, 休入時間を変更しないように休憩時間長が更新されます
- 休憩時間長を変更すると, 休入時間を変更しないように休出時間が更新されます

## バー型シフト表示/操作用コントロール
グラフィカルなシフト表示と, マウス操作にてシフト編集を行う機能を提供するコントロールです.

- バー表示の表示幅によってセルの時間幅が変わります
  - 時間幅の最小値は1分, 最大値は2時間です
- クリックによって勤務/休憩/非勤務を設定変更可能です
- ドラッグによってセルの状態反転が可能です

セルの表示時間幅と区切り線種の対応表は, 以下のとおりです.  なお, 「X」は該当なしを表します.  また, 転線が存在するのは細線のみで, 細線以外は実線のみ存在します.

|時間幅|細 点線|細 実線|標準線|太線|
|---:|---:|---:|---:|---:|
|2 Hour|X|X|2 Hour|X|
|1 Hour|X|X|1 Hour|X|
|30 min|X|X|30 min|1 Hour|
|15 min|X|15 min|30 min|1 Hour|
|10 min|X|10 min|30 min|1 Hour|
| 5 min|5 min|10 min|30 min|1 Hour|
| 1 min|1 min|5 min|15 min|1 Hour|

---
## (Tips) メニュー開閉
画面左上に表示されているハンバーガーボタン(三本線が表示されたボタン)を押下すると, 左に表示されているメニューが開閉します

画面を広く使いたい際にご利用ください.

本機能を無効化する場合は, 実行時引数に以下のオプションを指定します (未実装) なお, 既定値は`true`です

```
--CanOpenCloseMenu false
```

また, 初期状態でのメニューの開閉状態を指定するには, 実行時引数に以下のオプションを指定します (未実装) なお, 既定値は`true`です

```
--DefaultMenuState true
```
(`true`:開いている状態, `false`:閉じている状態)

なお, メニューを閉じた状態でメニュー開閉機能を無効化すると, ページ移動を行えなくなります.  最初に表示するページを選択する機能は未実装なので, ご注意ください.


## (Tips) 全画面表示
F11キーを押下することで, 通常モードと全画面モードを切り替えることができます.

本機能を無効化する場合は, 実行時引数に以下のオプションを指定します (未実装) なお, 既定値は`true`です

```
--CanChangeToFullScreen false
```

また, 初期状態でのウィンドウ状態を指定するには, 実行時引数に以下のオプションを指定します (未実装) なお, 既定値は`true`です

```
--InitWithFullScreen true
```
(true:フルスクリーン状態, false:通常状態)

---
## (Developer) 動作モード変更機能
F12キーを打鍵間隔0.5秒未満で5回以上連打することで, オンライン動作モードとオフライン動作モードを入れ替える機能です.

本機能を有効化する場合は, 実行時引数に以下のオプションを指定します (未実装) なお, 既定値は`false`です

```
--CanChangeRunningMode true
```

また, 初期状態での動作モードをオフラインモードにする場合, 実行時引数に以下のオプションを指定します. (未実装) なお, 既定値は`false`です

```
--OfflineStart true
```
